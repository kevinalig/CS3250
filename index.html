<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Team KAM</title>

    <!-- Bootstrap Core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">

    <!-- Theme CSS -->
    <link href="css/grayscale.min.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">

    <!-- Navigation -->
    <nav class="navbar navbar-custom navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-main-collapse">
                    Menu <i class="fa fa-bars"></i>
                </button>
                <a class="navbar-brand page-scroll" href="#page-top">
                    <i class="fa fa-play-circle"></i> <span class="light">TEAM</span> KAM
                </a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-right navbar-main-collapse">
                <ul class="nav navbar-nav">
                    <!-- Hidden li included to remove active class from about link when scrolled up past about section -->
                    <li class="hidden">
                        <a href="#page-top"></a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#overview">Overview</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#data">Data</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#hypothesis">Hypothesis</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#methodology">Methodology</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#conclusion">Conclusion</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#sources">Sources</a>
                    </li>
                    <li>
                        <a href="http://knoesis.org/people/derek/3250.html">CS 3250</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Intro Header -->
    <header class="intro">
        <div class="intro-body">
            <div class="container">
                <div class="row">
                    <div class="col-md-8 col-md-offset-2">
                        <h1 class="brand-heading">CS 3250</h1>
                        <p class="intro-text">Wagering on Races: A Study on How to Increase Payouts</p>
                        <a href="#overview" class="btn btn-circle page-scroll">
                            <i class="fa fa-angle-double-down animated"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- About Section -->
    <section id="overview" class="container content-section text-center">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2">
                <h2>Overview</h2>
                <p>Betting payout odds in horse racing are based on a parimutuel betting strategy.  The pool of money wagered, minus contestant prizes and “house” cut of about 15%, is divided so all winning combinations share the winnings.  This is similar to a lottery payout, except the number of wagers on each horse is known, while a lottery doesn’t know how many wagers are on each number combination until after the numbers are drawn.  Because the odds change based on wager amounts placed, the higher odds will have a lower payout per wager.  Hence a ‘long-shot’ horse (a horse with few wagers) will share the prize with fewer betters and will receive a higher payout.  Our goal with this research project is to increase the payout for an individual, and the following hypothesis aims to create data analysis experiments on the nature of the betting methods provided by institutions.</p>
            </div>
        </div>
    </section>

    <!-- Download Section -->
    <section id="data" class="content-section text-center">
        <div class="download-section">
            <div class="data">
                <div class="col-lg-8 col-lg-offset-2">
<!--                    <h2>CS 3250</h2>
                    <p></p>
-->                    <a href="https://promo.betfair.com/betfairsp/prices/index.php" class="btn btn-default btn-lg" target="_blank">Betfair Historical Datasets</a>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2">
                <img src="./img/csvScreenCap3.png">
                <h2>Data</h2>
                <p>Datasets for this study were obtained from the biggest betting exchange worldwide: Betfair (TheGuardian.com).  Betfair started its operations in 2000, with a steady growth that allowed the purchasing of England’s biggest horseracing publishing company, Timeform, in 2006. In 2009, Betfair purchased the TVG Network in the United States, which allowed for Betfair to offer wagering services in 31 of the States. Betfair also reached a deal in 2009 with the New York Racing Association, which allowed for Betfair to offer wagering and exchanges on Aqueduct’s thoroughbreeding races (ThoroughbredTimes.com).  More recently in 2015, Betfair merged with the biggest bookmaker in Ireland, Paddy Power, which cemented Betfair as the biggest betting exchange operating across the globe.  Although public access to archived data only extends back to 2007, the dataset Betfair holds on sport gamblings far surpass those offered by any other research firm or corporate entity such as ESPN.  Therefore, our datasets for this research topic are exclusively gathered from Betfair.</p>
                <p>Betfair offers an up-to-the-minute database via their API.  However, this requires an active account.  For our purposes, we require historical data rather than the latest data.  Betfair provides previous days’ racing data freely through its public website at the following link: https://promo.betfair.com/betfairsp/prices/index.php.  These .csv files date back to 2007 with data from horse racing in multiple countries, to include the United Kingdom, Ireland, Australia, the United States of America, and South Africa.  Collecting the off of their server was a trivial task with web-browser plug-in tools such as “DownloadThemAll”, which scrapes a server and downloads all dependent files from a public site.</p>
                <p>Each .csv file provided by Betfair has a patterned name of their ‘exchange-price-location-winnings-date’.  The files are formatted the same way internally.  Each file represents the days’ worth of races (times based out of Gibraltar).  Attributes in these files include the ‘Event ID’, ‘Name of Runner (horse)’, ‘Win/Lose (or ‘Place’; effectively 1st place, 2nd place, or loss), ‘Starting Price’ on wagers, and amount that each wager sways up to the time of the race as well as the amount of trading through the Betfair exchange.</p>
            </div>
        </div>
    </section>
    
    <!-- Hypothesis -->
    <section id="hypothesis" class="container content-section text-center">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2">
                <h2>Hypothesis</h2>
                    <p>Our first hypothesis postulates that a favored horse is not the most likely to win; therefore, betting against the favored horse should provide a bigger payout.  According to some analysts, the favored horse is simply a popularity contest (USAPlayers.com), so a bet on a favored horse simply leads to a smaller payout divided amongst many participants. We will look into our data set to show that the favorite horse is not necessarily the winner.</p>
                    <p>This first hypothesis brings us to the next approach in our analysis:  Betting on ‘lower odds’ (less favored) horses will provide a higher payout.  We propose that over the long run, placing wagers on horses with greater payouts could be a smarter bet given an enough length of time.  Since the payout of ‘lower-odds’ bets is higher than bets placed on favored horses, bets of this nature afford a higher margin of losses to increase payout over time.</p>
                    <p>An alternative to picking individual horses is to create wagers that fall into a ‘window of odds’.  Our data should show that when the odds vs the winner is averaged together, a grouping will emerge indicating where smart bets should be placed.  By comparing odds to actual winners, we believe the data analysis will show that inside of an odds window, say between 4-1 and 8-1, will provide the best chance of payout over time.</p>
            </div>
        </div>
    </section>

    <!-- Methodology -->
    <section id="methodology" class="container content-section text-center">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2">
                <h2>Methodology</h2>
                    <p>In thanks to the same attributes being present across all of the files, merging the files is also a trivial process.  In Windows, the command line shell allows for a simple argument of “[directory] copy *.csv mergedFileName.csv” (AnalystCave.com).  A Python script would require a File I/O function which itself would still be trivial (fout, for loop, write).</p>
                    <p>We have over 22,500 data sets gathered from Betfair, with an average of 120 rows of data per set.  The datasets offered by Betfair gives us two minor hurdles.  Their horseracing data mixes in their dog racing data.  Fortunately, greyhound race results are aptly named ‘greyhound’ as part of their filename and can easily be sorted out. The second issue comes in the form of poorly kept records; some races do not have betting data included.  Without the starting wagers, we do not have a way in which to calculate odds and favors.  Some datasets also exclude the list of winners and losers, which also hinders us from calculating final payouts based on wins.  Therefore, whenever we complete our data analysis in R, we will need to exclude entire ‘Event ID’ sets that do not have either a complete set of betting data or winners.</p>
                    <p>In order to answer our hypotheses regarding an overall favored horse’s likelihood to win its given race, we should have enough data points to provide a good probability model fitting a binomial distribution, since we are just measuring the win/loss (two-outcome) event per race.  With over 22,500 datasets based on daily events, each file contains an average of four events, meaning that our dataset for this probability model will have about 90,000 data points.  Although we have a large number of data points, a simple binomial distribution curve may be the best way to visualize this data.  Since our hypothesis is meant to provide insight into our big question of  ‘how to increase payouts from horse racing bets’, the normalized probability distribution should be directly proportional to the payout odds.  This same methodology would address our additional hypothesis in which we wish to see if we receive a better payout by betting on a horse favored in second to the top favored horse.</p>
                    <p>In order to analyze the data in regards to our first hypothesis, we want to focus on the favored horses. We will record how many times a horse with the highest total wager placed won or lost, and to compare those two results. This would not only give us an analysis on win/loss ratio, but it also shows how often a favored horse performs well on the racetrack. That in turn determines if that popular favorite should truly be voted on or not in order to maximize a good betting return.</p>
                    <p>We also want to know if placing a wager on a lower ranked horse increases our payout chances. We postulate that earnings from a lower-ranked wager can overcome money sunk into a loss.   A horse is lower ranked than the highest if it receives a lower average wager, which is an attribute provided in our datasets. The dataset also has information regarding the final amount that was wagered before the race began. To make an analysis, we  just need to compare the amount that was won or lost, and sum up all of these up over a specific time interval. If the result is positive, then all of the wagers were worth paying for at the end of the time frame.</p>
                    <p>To address our third hypothesis on a ‘window of odds’, we will need to create an artificial bracket of odds.  For example, a horse favored 1-1 to 5-1 are all grouped in the same bracket, then 6-1 to 10-1 are grouped in a different bracket, and so on and so forth.  This creates a sliding bracket (window) of odds.  Then in R, we can compare how many horses won per each window, with an accompanying bar graph for each betting window.  We will then create a correlated graph showing the payout for each bracket according to their winning probabilities.  This can be a dynamic graph that is generated in Tableau so that the user can switch between each graph (Tableau.com), overlay the graphs, or generate their own brackets and graphs using our data (as opposed to viewing our pre-made graphs).</p>
            </div>
        </div>
    </section>
    

    <!-- Conclusion -->
    <section id="conclusion" class="container content-section text-center">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2">
                <h2>Conclusions</h2>
                <h3>Hypothesis 1: Is a favored horse less likely to win, thereby providing less of a payout?</h3>
                <p>Here is the result of probabiliteis that the most favored horse would win a race from our simulation:</p>
                <p>2009: 47.9% win<br>
                    2010: 47.5% win<br>
                    2011: 48.0% win<br>
                    2012: 44.2% win<br>
                    2013: 42.7% win<br>
                    2014: 45.6% win<br>
                    2015: 46.0% win<br>
                    2016: 45.3%win</p>                
                <h3>Hypothesis 2:  Betting on ‘lower odds’ (less favored) horses will provide a higher payout.  Assuming the data set is complete, that is that all horses that competed, regardless of odds, is included and that the data is correct: placing a $1 wager everytime the LONG shot horse, with odds greater than 512 to 1, would result in the largest net winnings.</h3>
                <h3>Hypothesis 3: Is there a window of odds where the payout is greater?  In other words, rather than betting on a single horse, can we increase our chances of a higher payout by betting on a set of horses that sit in a range of favors?</h3>
                <p>Top 1 to 2 horses:  60.9% win<br>
                    Top 2 - 4 horses: 33.4% win<br>
                    Top 4 - 8 horses: 17.5% win<br>
                    Top 8 - 16 horses: 9.0% win<br>
                    Top 16 - 32 horses: 4.7% win<br>
                    Top 32 - 64 horses: 2.3% win<br>
                    Top 64 - 128 horses: 1.1% win<br>
                    Top 128 - 256 horses: 0.6% win<br>
                    Top 256 - 512 horses: 0.3% win<br>
                    Top 512 - 1024 horses: 0.2% win</p>
                <p><img src="./img/hyp3/Odds_1_2.jpeg"></p>
            </div>
        </div>
    </section>
    
    <!-- Hypothesis -->
    <section id="sources" class="container content-section text-center">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2">
                <h2>Works Cited</h2>
                    <p>"Betfair NYRA Reach Wagering Agreement." Thoroughbred Times. N.p., 02 Nov. 2009. Web. 26 Oct. 2016.</p>
                    <p>"Display Measures Dynamically." Tableau Software. N.p., 16 Aug. 2016. Web. 26 Oct. 2016.</p>
                    <p>"Horse Betting Guide." U.S. Players. N.p., n.d. Web. 26 Oct. 2016.</p>
                    <p>"Merge CSV Files or TXT Files in a Folder - Using Excel or CMD." The Analyst Cave Excel VBA Programming and More. N.p., Mar.-Apr. 2016. Web. 26 Oct. 2016.</p>
                    <p>"Will Betfair Become a Player in the U.S.? - Horse Racing News | Paulick Report." Horse Racing News Paulick Report. N.p., 2010. Web. 26 Oct. 2016.</p>
                    <p>Wood, Greg. "World's Biggest Betting Exchange Betfair and Paddy Power to Merge." The Guardian. Guardian News and Media, 2015. Web. 26 Oct. 2016.</p>
            </div>
        </div>
    </section>    
    
    

    <!-- Footer -->
    <footer>
        <div class="container text-center">
            <p>CS 3250 | Team KAM</p>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="vendor/jquery/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>

    <!-- Google Maps API Key - Use your own API key to enable the map feature. More information on the Google Maps API can be found at https://developers.google.com/maps/ -->
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCRngKslUGJTlibkQ3FkfTxj3Xss1UlZDA&sensor=false"></script>

    <!-- Theme JavaScript -->
    <script src="js/grayscale.min.js"></script>

</body>

</html>
